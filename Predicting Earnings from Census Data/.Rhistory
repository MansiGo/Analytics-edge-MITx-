setwd("C:/Users/Mansi/Documents/Assignments/Analytics Edge/Analytics edge (GitHub)/RPredicting earnings from census data")
census<-read.csv(paste("census.csv"))
set.seed(2000)
spl=sample.split(census$over50k, SplitRatio=0.6)
library(caTools)
spl=sample.split(census$over50k, SplitRatio=0.6)
train=subset(census, spl=TRUE)
test=subset(census, spl=FALSE)
model3=rpart(over50k~., data=train, method="class")
library(rpart)
library(rpart.plot)
model3=rpart(over50k~., data=train, method="class")
prp(model3)
set.seed(1)
trainSmall = train[sample(nrow(train), 2000), ]
library(randomForest)
set.seed(1)
model4=randomForest(over50k~., data=trainSmall)
predict4=predict(model4, newdata=test)
predict4=predict(model4, newdata=test)
table(test$over50k, predict4) # Confusion matrix
vu = varUsed(model4, count=TRUE) #a certain variable is selected for a split
vusorted = sort(vu, decreasing = FALSE, index.return = TRUE)
dotchart(vusorted$x, names(model4$forest$xlevels[vusorted$ix]))
varImpPlot(model4)
varImpPlot(model4)
varImpPlot(model4)
cartGrid = expand.grid( .cp = seq(0.002,0.1,0.002))
model5=rpart(over50k~., data=train, method="class", cp=0.002)
predict5=predict(model5, newdata=test, type="class")
prp(model5)
